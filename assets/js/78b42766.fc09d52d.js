"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[413],{5959:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>u,frontMatter:()=>o,metadata:()=>d,toc:()=>a});var r=i(4848),s=i(8453);const o={title:"Making Liquid Production Ready"},t=void 0,d={id:"Making-Liquid-Production-Ready",title:"Making Liquid Production Ready",description:"Important backend configurations to update",source:"@site/docs/Making-Liquid-Production-Ready.md",sourceDirName:".",slug:"/Making-Liquid-Production-Ready",permalink:"/Making-Liquid-Production-Ready",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Making Liquid Production Ready"},sidebar:"tutorialSidebar",previous:{title:"Setup",permalink:"/Setup"},next:{title:"Understanding Access Control and Integrating with other Microservices",permalink:"/Understanding-Access-Control-and-Integrating-with-Other-Microservices"}},c={},a=[{value:"Important backend configurations to update",id:"important-backend-configurations-to-update",level:2},{value:"Cookie Configurations:",id:"cookie-configurations",level:3},{value:"Core Environmental Configurations:",id:"core-environmental-configurations",level:3},{value:"Account Creation and Email Adapter Configurations:",id:"account-creation-and-email-adapter-configurations",level:3},{value:"Using Nodemailer:",id:"using-nodemailer",level:4},{value:"Using Amazon SES:",id:"using-amazon-ses",level:4},{value:"Using Sendgrid:",id:"using-sendgrid",level:4},{value:"Using Message Queue (Pusher):",id:"using-message-queue-pusher",level:4},{value:"Caching:",id:"caching",level:3},{value:"Database:",id:"database",level:3},{value:"Recommended configurations for MongoDB",id:"recommended-configurations-for-mongodb",level:2},{value:"Recommended configurations for account creation",id:"recommended-configurations-for-account-creation",level:2},{value:"Special Configurations for Nginx Reverse Proxy",id:"special-configurations-for-nginx-reverse-proxy",level:2}];function l(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"important-backend-configurations-to-update",children:"Important backend configurations to update"}),"\n",(0,r.jsx)(n.p,{children:"To make Liquid production ready, there are a few recommended configurations to be done on the backend side:"}),"\n",(0,r.jsx)(n.h3,{id:"cookie-configurations",children:"Cookie Configurations:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"cookie-session-secret"})})," to a secure random string. You can use ",(0,r.jsx)(n.a,{href:"https://www.uuidgenerator.net/guid",children:"this tool"})," to generate one."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"cookie.secure"})})," to true."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"core-environmental-configurations",children:"Core Environmental Configurations:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"system.reverse-proxy-mode"})})," to true if you intend to use a reverse proxy like Nginx."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"environment"})})," to production."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"account-creation-and-email-adapter-configurations",children:"Account Creation and Email Adapter Configurations:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"email.outbound-address"})})," to the email address that you intend to send emails to users from. It is important that this address matches the email address configured in your mail adapter."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"user.account-creation.require-email-verification"})})," to true."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"privilege.can-reset-password"})})," to true."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"To send outbound emails from Liquid, say, for account verification and password reset, you can either use a Sendgrid account or your own SMTP server by configuring Nodemailer."}),"\n",(0,r.jsx)(n.h4,{id:"using-nodemailer",children:"Using Nodemailer:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"system.email-adapter"})})," to ",(0,r.jsx)(n.code,{children:"nodemailer"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"nodemailer.service-name"})})," to ",(0,r.jsx)(n.code,{children:"gmail"})," or ",(0,r.jsx)(n.code,{children:"outlook"})," if you use those services. Do not set if you are using a custom SMTP server."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"nodemailer.host"})})," to your SMTP server host."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"nodemailer.port"})})," to your SMTP server port."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"nodemailer.secure"})})," to true if your SMTP server uses a secure connection."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"nodemailer.username"})})," to the username of your SMTP account."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"nodemailer.password"})})," to the password of your SMTP account."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"using-amazon-ses",children:"Using Amazon SES:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"system.email-adapter"})})," to ",(0,r.jsx)(n.code,{children:"ses"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"aws.ses.region"})})," to your AWS region."]}),"\n",(0,r.jsxs)(n.li,{children:["Set the ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"aws.ses.access-key-id"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Set the ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"aws.ses.access-key-secret"})}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"using-sendgrid",children:"Using Sendgrid:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"system.email-adapter"})})," to ",(0,r.jsx)(n.code,{children:"sendgrid"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"sendgrid.api-key"})})," to your SendGrid API key."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"using-message-queue-pusher",children:"Using Message Queue (Pusher):"}),"\n",(0,r.jsx)(n.p,{children:"If none of the built-in email providers meet your needs, Liquid can put emails to a queue so that another service can consume them and send emails using your preferred custom provider."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"system.email-adapter"})})," to ",(0,r.jsx)(n.code,{children:"pusher"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"privilege.can-use-push-events"})})," to ",(0,r.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Configure your message queue by setting ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"system.queue-adapter"})})," to either ",(0,r.jsx)(n.code,{children:"redis"})," or ",(0,r.jsx)(n.code,{children:"rabbitmq"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Configure the appropriate queue service (Redis or RabbitMQ) settings."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["You should now get a ",(0,r.jsx)(n.code,{children:"liquid.email.send"})," when an email is triggered."]}),"\n",(0,r.jsx)(n.h3,{id:"caching",children:"Caching:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"privilege.can-use-cache"})})," to true."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"redis.port"})}),", ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"redis.host"})}),", ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"redis.username"})}),", ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"redis.password"})}),", and ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"redis.db"})}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"database",children:"Database:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"mongo-db.connection-string"})})," to your MongoDB URL."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"recommended-configurations-for-mongodb",children:"Recommended configurations for MongoDB"}),"\n",(0,r.jsxs)(n.p,{children:["In a production setup, we recommend turning on transactions by setting the option ",(0,r.jsx)(n.code,{children:"mongo-db.use-transactions"})," to true. This makes sure API calls with multiple write operations don't result in inconsistent database states if some of them fail and some of them succeed."]}),"\n",(0,r.jsx)(n.h2,{id:"recommended-configurations-for-account-creation",children:"Recommended configurations for account creation"}),"\n",(0,r.jsx)(n.p,{children:"To reduce the amount of spam accounts, Liquid has an IP based user account creation throttling mechanism."}),"\n",(0,r.jsx)(n.p,{children:"Use the following options to adjust this throttling:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"user.account-creation.enable-ip-based-throttle"})})," to ",(0,r.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["The window size for the throttle can be controlled by setting the option ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"user.account-creation.ip-based-throttle.window-size"})})," to the desired number of seconds. For example, if you set ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"user.account-creation.ip-based-throttle.window-size"})})," to 3600, Liquid will allow only one account per hour to be created from the same IP."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"special-configurations-for-nginx-reverse-proxy",children:"Special Configurations for Nginx Reverse Proxy"}),"\n",(0,r.jsxs)(n.p,{children:["It is important that you configure the ",(0,r.jsx)(n.code,{children:"headers X-Forwarded-Proto"})," and ",(0,r.jsx)(n.code,{children:"X-Forwarded-For"})," as follows to ensure that the security features work properly:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:"location / {\n  # other reverse proxy configurations...\n  proxy_set_header X-Forwarded-Proto $scheme;\n  proxy_set_header X-Forwarded-For $remote_addr;\n}\n"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>d});var r=i(6540);const s={},o=r.createContext(s);function t(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);